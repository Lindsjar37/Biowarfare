<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Game.Views.BattlePage"
             >

    <NavigationPage.TitleView>

        <!--Menu Bar-->
        <StackLayout Style="{StaticResource HorizontalStack}" 
                     HorizontalOptions="StartAndExpand" 
                     VerticalOptions="StartAndExpand"
                     >

            <Frame Style="{StaticResource BattlePageNavFrame}"/>

            <Label Text="BioWarfare" 
                   Style="{StaticResource NavLabel}" 
                   HorizontalOptions="Start"
                   />

            <Frame Style="{StaticResource BattlePageNavFrame}"/>

            <Label x:Name="BattleModeValue"
                   Text="" 
                   Style="{StaticResource BattlePageNavLabelStyle}" 
                   />

            <ImageButton Source="edit_main_icon.png" 
                         Clicked="Setttings_Clicked" 
                         Style="{StaticResource BattleToolbarStyle}"
                         BackgroundColor="Transparent"
                         HorizontalOptions="End"
                         />

            <ImageButton Source="cancel_x_main.png"
                         Clicked="ExitButton_Clicked" 
                         BackgroundColor="Transparent"
                         Style="{StaticResource BattleToolbarStyle}" 
                         HorizontalOptions="End"
                         />

            <Frame Style="{StaticResource BattlePageNavFrame}"/>

        </StackLayout>
    </NavigationPage.TitleView>

    <ContentPage.Content>
        <AbsoluteLayout IsVisible="True"
                        Style="{StaticResource BattleAbsoluteLayoutStyle}"
                        >

            <!--The Game UI Screen -->
            <StackLayout Style="{StaticResource GameUiStackLayoutStyle}"
                         x:Name="GameUIDisplay" 
                         IsVisible="True" 
                         >

                <!--The Top of the Battle UI Holds the List of Players-->
                <StackLayout VerticalOptions="Start" 
                             x:Name="TopPlayerDisplay"
                             >
                    
                    <StackLayout Style="{StaticResource VerticalStack}"
                                 x:Name="GamePlayersTopDisplay" 
                                 IsVisible="False" 
                                 VerticalOptions="Start" 
                                 HorizontalOptions="CenterAndExpand"
                                 >

                        <Label Text="Characters" 
                               Style="{StaticResource CenterMessageStyle}" 
                               HorizontalOptions="CenterAndExpand"
                               />
                        
                        <StackLayout x:Name="CharacterBox" 
                                     Style="{StaticResource HorizontalStack}" 
                                     HorizontalOptions="CenterAndExpand"
                                     />

                        <Label Text="Monsters" 
                               Style="{StaticResource CenterMessageStyle}" 
                               HorizontalOptions="CenterAndExpand"
                               />
                        
                        <StackLayout x:Name="MonsterBox" 
                                     Style="{StaticResource HorizontalStack}" 
                                     HorizontalOptions="CenterAndExpand"
                                     />
                        
                    </StackLayout>
                </StackLayout>

                <!--The Battle Map Display -->
                <StackLayout x:Name="BattleMapDisplay" 
                             Style="{StaticResource BattleMapBox}"  
                             HorizontalOptions="CenterAndExpand" 
                             VerticalOptions="Start"
                             
                             >
                    
                    <AbsoluteLayout HorizontalOptions="CenterAndExpand" 
                                    VerticalOptions="CenterAndExpand"
                                    >
                        
                        <Grid x:Name="MapGrid"
                              Style="{StaticResource BattlePageGridStyle}"
                              >
                            
                        </Grid>
                    </AbsoluteLayout>
                </StackLayout>

                <!--<AbsoluteLayout Margin="0, 10"
                                IsVisible="False"
                                HorizontalOptions="CenterAndExpand"
                                x:Name="BattleInfoAndActions"
                                >
                    
                    <StackLayout Orientation="Horizontal">

                        <Frame Style="{StaticResource BattlePageFrameStyle}"
                               >
                            <Label x:Name="BattleMessagesForAllActions"
                                   Padding="10"/>
                        </Frame>
                        
                        
                        <StackLayout Orientation="Vertical" 
                                     HorizontalOptions="FillAndExpand"
                                     >
                            
                            <ImageButton Source="start_main.png" 
                                         Style="{StaticResource ImageButtonGameStyle}"
                                         />
                            
                            <ImageButton Source="start_main.png" 
                                         Style="{StaticResource ImageButtonGameStyle}"
                                         />
                            
                            -->

                <!--The Bottom of the Battle UI  Holds the Player to Player boxes, Buttons, and the Messages-->
                <StackLayout x:Name="BattleBottomBox" 
                             Style="{StaticResource BattleUIBottomBox}"
                             Margin="0, 60">

                    <Frame x:Name="BattlePlayerInfomationBox"
                           Style="{StaticResource BattlePageFrameStyle}"
                           IsVisible="False"
                           HorizontalOptions="CenterAndExpand"
                           WidthRequest="300"
                           HeightRequest="600"
                           Padding="10">

                        <StackLayout x:Name="BattlePlayerBox" 
                                     Style="{StaticResource PlayerBattleOuterBox}"
                                     >
                            
                            <StackLayout x:Name="AttackerBox" 
                                         Style="{StaticResource PlayerBattleInfoBox}" 
                                         HorizontalOptions="Start"
                                         >
                                
                                <Image x:Name="AttackerImage" Source="item.png" 
                                       Style="{StaticResource ImageBattleMediumStyle}"
                                       />
                                
                                <Label x:Name="AttackerName" 
                                       Text="" 
                                       Style="{StaticResource ValueStyleBattleMicro}"
                                       />
                                
                                <Label x:Name="AttackerHealth" 
                                       Text="" 
                                       Style="{StaticResource ValueStyleBattleMicro}"
                                       />
                                
                            </StackLayout>

                            <StackLayout HorizontalOptions="Center" 
                                         VerticalOptions="Center"
                                         >
                                
                                <Label x:Name="BattlePlayerBoxVersus" 
                                       Text="vs" 
                                       Style="{StaticResource ValueStyleBattleMicro}"
                                       Padding="0,5,0,0"
                                       VerticalOptions="Center" 
                                       VerticalTextAlignment="Center" 
                                       HorizontalOptions="Center" 
                                       HorizontalTextAlignment="Center"
                                       />
                                
                                <Image x:Name="AttackerAttack" 
                                       Source="mapcell.png" 
                                       Style="{StaticResource ImageSmallStyle}"
                                       />
                                
                            </StackLayout>

                            <StackLayout x:Name="DefenderBox" 
                                         Style="{StaticResource PlayerBattleInfoBox}" 
                                         HorizontalOptions="End"
                                         >
                                
                                <Image x:Name="DefenderImage" 
                                       Source="item.png" 
                                       Style="{StaticResource ImageBattleMediumStyle}"
                                       />
                                
                                <Label x:Name="DefenderName" 
                                       Text="" 
                                       Style="{StaticResource ValueStyleBattleMicro}"
                                       />
                                
                                <Label x:Name="DefenderHealth" 
                                       Text="" 
                                       Style="{StaticResource ValueStyleBattleMicro}"
                                       />
                                
                            </StackLayout>
                        </StackLayout>
                    </Frame>
                    <!--Battle Grammar Buttons-->
                    <StackLayout Style="{StaticResource HorizontalStack}" 
                                 HorizontalOptions= "CenterAndExpand"
                                 >

                        <ImageButton Source="use_ability_main.png" 
                                     x:Name="UseAbilityButton" 
                                     IsVisible="False" 
                                     Style="{StaticResource ImageButtonGameStyle}"
                                     WidthRequest="100"/>

                        <ImageButton Source="attack_main.png" 
                                     Clicked="AttackButton_Clicked"
                                     x:Name="AttackButton"
                                     IsVisible="true" 
                                     Style="{StaticResource ImageButtonGameStyle}"
                                     WidthRequest="100"/>

                        <!--<Button x:Name="AttackButton" 
                                Clicked="AttackButton_Clicked" 
                                Text="Next Attack" 
                                IsVisible="False"
                                />-->

                        <ImageButton Source="use_item_main.png" 
                                     x:Name="UseItemButton"
                                     IsVisible="False" 
                                     Style="{StaticResource ImageButtonGameStyle}"
                                     WidthRequest="100"
                                     Clicked="UseItemButton_Clicked"/>
                                    

                        <Button x:Name="NextRoundButton" 
                                Clicked="NextRoundButton_Clicked" 
                                Text="Next Round" 
                                IsVisible="False"
                                />
                        
                        <ImageButton Source="start_main.png" 
                                     x:Name="StartBattleButton"
                                     Clicked="StartButton_Clicked" 
                                     IsVisible="False" 
                                     Style="{StaticResource ImageButtonGameStyle}"
                                     />
                        
                    </StackLayout>

                    <!--Battle Grammar Messages-->
                    <StackLayout Style="{StaticResource VerticalStack}" 
                                 HeightRequest="100"
                                 HorizontalOptions="CenterAndExpand"
                                 >
                        
                        <StackLayout x:Name="MessageDisplayBox" 
                                     IsVisible="false"
                                     Style="{StaticResource VerticalStack}" 
                                     VerticalOptions="EndAndExpand"
                                     HorizontalOptions="CenterAndExpand"
                                     >
                            
                            <Label x:Name="BattleMessages" 
                                    HorizontalOptions="FillAndExpand" 
                                    LineBreakMode="WordWrap" 
                                    MaxLines="3"
                                    LineHeight="1"
                                    CharacterSpacing="1"
                                    Style="{StaticResource LabelStyle}"
                                    FontSize="Micro"
                                   />

                            <!--<WebView
                        x:Name="HtmlBox"
                        WidthRequest="100"
                        MinimumWidthRequest="100"
                        HeightRequest="100"
                        MinimumHeightRequest="100"
                        HorizontalOptions="FillAndExpand"
                        VerticalOptions="Start"
                        BackgroundColor="Transparent"
                        IsVisible="false"
                        />-->
                        </StackLayout>
                    </StackLayout>
                </StackLayout>
            </StackLayout>

            <!--The Game Over Screen -->
            <StackLayout Style="{StaticResource GameOverStackLayoutStyle}"
                         x:Name="GameOverDisplay" 
                         IsVisible="false"
                         >

                <StackLayout Style="{StaticResource InnerGameOverStackLayoutStyle}">
                    
                    <Label Text="Thank you for Playing" 
                           Style="{StaticResource CenterMessageLargeStyle}"
                           />
                    
                    <Label Text="Check your score, or click Exit and return soon" 
                           Style="{StaticResource MessageStyle}" 
                           />
                    
                    <ImageButton x:Name="ShowScoreButton"
                                 Style="{StaticResource ImageButtonGameStyle}"
                            Clicked="ShowScoreButton_Clicked" 
                           Source="view_scores_main.png"
                           
                            />
                    
                    <Button x:Name="ExitButton" 
                            Clicked="ExitButton_Clicked" 
                            Text="Exit" 
                            WidthRequest="50"
                            >
                        
                    </Button>
                </StackLayout>
            </StackLayout>
            
            
            <Frame Style="{StaticResource RoundPagePopupFrameStyle}"
                   x:Name="CharacterPopUpFrame"
                   IsVisible="false">

                <StackLayout Style="{StaticResource PopupStackLayoutStyle}">

                    <ImageButton Style="{StaticResource ClosePopupButtonStyle}"
                                 Source="cancel_x_main.png"
                                 WidthRequest="20"
                                 HeightRequest="30"
                                 Clicked="ClosePopup_Clicked"/>

                    <Frame Style="{StaticResource RoundPagePopupTitleFrameStyle}"
                           HeightRequest="20">

                        <Label Style="{StaticResource RoundPagePopupLabelStyle}"
                               Text="Name goes here, I guess"
                               FontSize="Caption"
                               x:Name="CharacterPopUpName" />

                    </Frame>

                    <Frame Style="{StaticResource ItemImageCircleFrameStyle}"
                           WidthRequest="70"
                           HeightRequest="70">

                        <Image x:Name="CharacterPopUpImage" />

                    </Frame>

                    <Frame Style="{StaticResource RoundPageInvisibleFrameStyle}"
                           WidthRequest="500">

                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="AUTO" />
                                <RowDefinition Height="AUTO" />
                                <RowDefinition Height="AUTO" />
                            </Grid.RowDefinitions>

                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="200"/>
                                <ColumnDefinition Width="100" />
                            </Grid.ColumnDefinitions>

                            <StackLayout Orientation="Horizontal"
                                         Grid.Row="0"
                                         Grid.Column="0"
                                         Margin="20, 0">

                                <Label Text="Cell Type:"
                                       HorizontalOptions="StartAndExpand"
                                       Style="{StaticResource RoundPagePopupCellTypeLabelStyle}"
                                       />
                                
                                <Label Text="Macrophage"
                                       HorizontalOptions="StartAndExpand"
                                       Style="{StaticResource RoundPagePopupCellTypeRegularLabelStyle}"
                                       x:Name="CharacterPopupCellType"/>

                            </StackLayout>

                            <StackLayout Orientation="Horizontal"
                                         Grid.Row="1"
                                         Grid.Column="0"
                                         Margin="20, 0">

                                <Label Text="HP:"
                                       HorizontalOptions="StartAndExpand"
                                       Style="{StaticResource RoundPagePopupCellTypeLabelStyle}"/>
                                
                                <Label Text="25 / 25"
                                       HorizontalOptions="StartAndExpand"
                                       Style="{StaticResource RoundPagePopupCellTypeRegularLabelStyle}"
                                       x:Name="CharacterPopupHealth"/>

                            </StackLayout>

                            <StackLayout Orientation="Horizontal"
                                         Grid.Row="2"
                                         Grid.Column="0"
                                         Margin="20, 0">

                                <Label Text="Status:"
                                       HorizontalOptions="StartAndExpand"
                                       Style="{StaticResource RoundPagePopupCellTypeLabelStyle}"/>

                                <Label Text="Poison"
                                       HorizontalOptions="StartAndExpand"
                                       Style="{StaticResource RoundPagePopupCellTypeRegularLabelStyle}"
                                       x:Name="CharacterPopupStatus"/>

                            </StackLayout>

                            <StackLayout Orientation="Horizontal"
                                         Grid.Row="0"
                                         Grid.Column="1"
                                         >

                                <Label Text="Attack: " 
                                       HorizontalOptions="StartAndExpand"
                                       Style="{StaticResource RoundPagePopupCellTypeLabelStyle}"/>
                                
                                <Label Text="99"
                                       Style="{StaticResource RoundPagePopupCellTypeRegularLabelStyle}"
                                       x:Name="CharacterPopupAttack"/>

                            </StackLayout>

                            <StackLayout Orientation="Horizontal"
                                         Grid.Row="1"
                                         Grid.Column="1">

                                <Label Text="Defense: "
                                       HorizontalOptions="StartAndExpand"
                                       Style="{StaticResource RoundPagePopupCellTypeLabelStyle}"/>
                                
                                <Label Text="99"
                                       Style="{StaticResource RoundPagePopupCellTypeRegularLabelStyle}"
                                       x:Name="CharacterPopupDefense"/>

                            </StackLayout>

                            <StackLayout Orientation="Horizontal"
                                         Grid.Row="2"
                                         Grid.Column="1">

                                <Label Text="Speed: "
                                       HorizontalOptions="StartAndExpand"
                                       Style="{StaticResource RoundPagePopupCellTypeLabelStyle}" />
                                
                                <Label Text="99"
                                       Style="{StaticResource RoundPagePopupCellTypeRegularLabelStyle}"
                                       x:Name="CharacterPopupSpeed"/>

                            </StackLayout>

                            <!--<Label Style="{StaticResource RoundPagePopupCellTypeLabelStyle}"
                                   Text="Cell Type: "
                                   Grid.Row="0"
                                   Grid.Column="0" />

                            <Label Style="{StaticResource RoundPagePopupCellTypeRegularLabelStyle}"
                                   x:Name="CharacterPopupCellType"
                                   Grid.Row="0"
                                   Grid.Column="1" />

                            <Label Style="{StaticResource RoundPagePopupCellTypeLabelStyle}"
                                   Text="Level: "
                                   Grid.Row="1"
                                   Grid.Column="0" />

                            <Label Style="{StaticResource RoundPagePopupCellTypeRegularLabelStyle}"
                                   x:Name="CharacterPopupLevel"
                                   Grid.Row="1"
                                   Grid.Column="1" />-->

                        </Grid>
                    </Frame>

                    <Frame Style="{StaticResource RoundPageStatsFrameStyle}">

                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>

                            <Frame Grid.Row="0"
                                   Style="{StaticResource RoundPagePopupAttributeFrameStyle}">

                            </Frame>

                            <Button Style="{StaticResource RoundPagePopupButtonStyle}"
                                    Grid.Row="0"
                                    Text="Emergency Kit"
                                    FontSize="Small"
                                    x:Name="ItemAttributeToggleButton"
                                     />

                            <ScrollView Style="{StaticResource RoundPageAttributeScrollViewStyle}"
                                        Grid.Row="1"
                                        x:Name="ItemsFrame"
                                        IsVisible="false">

                                <FlexLayout Style="{StaticResource ReadPageFlexLayoutStyle}"
                                            x:Name="ItemBox" />

                            </ScrollView>
                        </Grid>
                    </Frame>
                </StackLayout>
            </Frame>

        </AbsoluteLayout>
    </ContentPage.Content>
</ContentPage>